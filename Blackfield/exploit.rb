require 'winrm'
        
        conn = WinRM::Connection.new(
        endpoint: 'http://10.10.10.192:5985/wsman',
        user: 'svc_backup',
        password: '9658d1d1dcd9250115e2205d9f48400d',
        domain: 'Blackfield.local'	
        )

        command=""

        conn.shell(:powershell) do |shell|
        until command == "exit\n" do
        print "PS > "
        command = gets        
        output = shell.run(command) do |stdout, stderr|
            STDOUT.print stdout
            STDERR.print stderr
        end
    end    
    puts "Exiting with code #{output.exitcode}"
end
